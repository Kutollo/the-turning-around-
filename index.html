<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>30 Day Challenge Tracker</title>
<style>
  body {
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background-size: cover;
    background-position: center;
    transition: background-image 1s ease-in-out;
    color: #333;
  }
  header {
    text-align: center;
    padding: 1rem;
    background: rgba(255,255,255,0.8);
  }
  h1 { margin:0; }
  .verse-box, .progress-container, .calendar-container, .chart-container {
    max-width: 800px;
    margin: 1rem auto;
    padding: 1rem;
    background: rgba(255,255,255,0.8);
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  .calendar {
    display: grid;
    grid-template-columns: repeat(7,1fr);
    gap:5px;
  }
  .day {
    padding:10px;
    border-radius:6px;
    background:white;
    text-align:center;
    cursor:pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .day.completed { background:#b2f7b0; }
  .day.today { border:2px solid #4a6fa5; font-weight:bold; background:#dce9ff; }
  .progress-bar {
    height: 20px;
    width: 0%;
    background:#4a6fa5;
    border-radius: 10px;
    text-align:center;
    color:white;
    line-height:20px;
    transition: width 0.3s;
  }
  .modal {
    display:none;
    position:fixed;
    top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.5);
    justify-content:center;
    align-items:center;
    z-index:100;
  }
  .modal-content {
    background:white;
    padding:1rem;
    border-radius:10px;
    max-width:400px;
    width:90%;
  }
  .close { float:right; cursor:pointer; font-weight:bold; }
  input[type=checkbox]{margin-right:8px;}
  input[type=number]{width:80px;}
  canvas { background: rgba(255,255,255,0.8); border-radius:12px; }
</style>
</head>
<body>
<header>
<h1>30 Day Challenge Tracker</h1>
<p>Faith-based journey, health and habits</p>
</header>

<div class="verse-box">
  <h3>Verse of the Day</h3>
  <p id="verse"></p>
  <h3>Motivational Quote</h3>
  <p id="quote"></p>
</div>

<div class="progress-container">
  <div class="progress-bar" id="progress-bar">0%</div>
</div>

<div class="calendar-container">
<h2 style="text-align:center;">Calendar</h2>
<div class="calendar" id="calendar"></div>
</div>

<div class="chart-container">
<h2 style="text-align:center;">Weight Progress</h2>
<canvas id="weightChart" width="700" height="300"></canvas>
</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" id="modal-close">&times;</span>
    <h3 id="modal-day-title">Day</h3>
    <div>
      <label><input type="checkbox" id="habit-sugar"> No Sugar</label><br>
      <label><input type="checkbox" id="habit-junk"> No Fast Food</label><br>
      <label><input type="checkbox" id="habit-private"> Private Goal</label><br>
    </div>
    <div style="margin-top:10px;" id="weight-input-div">
      <label>Weight: <input type="number" id="weight-input"> kg</label>
    </div>
    <div style="margin-top:10px;">
      <textarea id="note" rows="4" style="width:100%;" placeholder="Notes/Reflections"></textarea>
    </div>
    <button id="save-day" style="margin-top:10px;">Save</button>
  </div>
</div>

<script>
const verses=[
"I can do all things through Christ who strengthens me. — Philippians 4:13",
"So whether you eat or drink or whatever you do, do it all for the glory of God. — 1 Corinthians 10:31",
"Let us not become weary in doing good, for at the proper time we will reap a harvest if we do not give up. — Galatians 6:9",
"For God gave us a spirit not of fear but of power and love and self-control. — 2 Timothy 1:7",
"The Lord is my strength and my shield; my heart trusts in him, and he helps me. — Psalm 28:7"
];
const quotes=[
"Every step counts, small changes build steady habits.",
"Discipline today gifts freedom tomorrow.",
"Stay strong, stay faithful, your efforts matter."
];
const images=[
'https://plus.unsplash.com/premium_photo-1671599016130-7882dbff302f?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8bW90aXZhdGlvbmFsfGVufDB8fDB8fHww',
'https://images.unsplash.com/photo-1528716321680-815a8cdb8cbe?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8bW90aXZhdGlvbmFsfGVufDB8fDB8fHww',
'https://plus.unsplash.com/premium_photo-1674489620667-eaf4a0094996?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8bW90aXZhdGlvbmFsfGVufDB8fDB8fHww',
'https://images.unsplash.com/photo-1564410267841-915d8e4d71ea?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8bW90aXZhdGlvbmFsfGVufDB8fDB8fHww',
'https://plus.unsplash.com/premium_photo-1694822449501-59bb095f39f2?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTN8fG1vdGl2YXRpb25hbHxlbnwwfHwwfHx8MA%3D%3D',
'https://images.unsplash.com/photo-1617251137884-f135eccf6942?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mzh8fG1vdGl2YXRpb25hbHxlbnwwfHwwfHx8MA%3D%3D'
];
function updateBackground(){
  const index=new Date().getDate()%images.length;
  document.body.style.backgroundImage=`url(${images[index]})`;
}
updateBackground();

const today=new Date();
const calendar=document.getElementById('calendar');
let state=JSON.parse(localStorage.getItem('challengeState'))||{};
if(!state.days){state.days={};for(let i=1;i<=30;i++)state.days[i]={sugar:false,junk:false,private:false,note:'',weight:''};}

function updateProgressBar(){
  let completed=0;
  for(let i=1;i<=30;i++){
    const d=state.days[i];
    if(d.sugar&&d.junk&&d.private)completed++;
  }
  const percent=Math.round((completed/30)*100);
  const bar=document.getElementById('progress-bar');
  bar.style.width=percent+'%';
  bar.textContent=percent+'%';
}

function generateCalendar(){
  calendar.innerHTML='';
  const firstDay=new Date(today.getFullYear(),today.getMonth(),1).getDay();
  const lastDay=new Date(today.getFullYear(),today.getMonth()+1,0).getDate();
  for(let i=0;i<firstDay;i++)calendar.appendChild(document.createElement('div'));
  for(let d=1;d<=lastDay;d++){
    const dayEl=document.createElement('div');
    dayEl.textContent=d;
    dayEl.classList.add('day');
    if(d===today.getDate())dayEl.classList.add('today');
    dayEl.dataset.day=d;
    dayEl.addEventListener('click',()=>openModal(d));
    if(state.days[d] && state.days[d].sugar && state.days[d].junk && state.days[d].private) dayEl.classList.add('completed');
    calendar.appendChild(dayEl);
  }
}

function openModal(day){
  const modal=document.getElementById('modal');
  modal.style.display='flex';
  document.getElementById('modal-day-title').textContent=`Day ${day}`;
  const data=state.days[day];
  document.getElementById('habit-sugar').checked=data.sugar;
  document.getElementById('habit-junk').checked=data.junk;
  document.getElementById('habit-private').checked=data.private;
  document.getElementById('note').value=data.note;
  const weightDiv=document.getElementById('weight-input-div');
  if(day%5===0){ weightDiv.style.display='block'; document.getElementById('weight-input').value=data.weight; }
  else weightDiv.style.display='none';
  document.getElementById('save-day').onclick=()=>saveDay(day);
}

function saveDay(day){
  const data=state.days[day];
  data.sugar=document.getElementById('habit-sugar').checked;
  data.junk=document.getElementById('habit-junk').checked;
  data.private=document.getElementById('habit-private').checked;
  data.note=document.getElementById('note').value;
  if(day%5===0) data.weight=document.getElementById('weight-input').value;
  localStorage.setItem('challengeState',JSON.stringify(state));
  generateCalendar();
  updateProgressBar();
  modal.style.display='none';
  updateChart();
}

document.getElementById('modal-close').onclick=()=>document.getElementById('modal').style.display='none';
generateCalendar();
updateProgressBar();

function getRandom(array){ return array[Math.floor(Math.random()*array.length)]; }
document.getElementById('verse').textContent=getRandom(verses);
document.getElementById('quote').textContent=getRandom(quotes);

// Weight Chart
const ctx=document.getElementById('weightChart').getContext('2d');
let chart=null;
function updateChart(){
  const labels=[]; const dataArr=[];
  for(let i=5;i<=30;i+=5){
    labels.push(`Day ${i}`);
    const w=state.days[i] ? state.days[i].weight : null;
    dataArr.push(w || null);
  }
  if(chart) chart.destroy();
  chart=new Chart(ctx,{ type:'line', data:{ labels, datasets:[{ label:'Weight (kg)', data:dataArr, fill:false, borderColor:'#4a6fa5', tension:0.2, pointBackgroundColor:'#4a6fa5' }] }, options:{ responsive:true, scales:{ y:{ beginAtZero:false } } } });
}

// Include Chart.js
const script=document.createElement('script');
script.src='https://cdn.jsdelivr.net/npm/chart.js';
document.head.appendChild(script);
script.onload=()=>updateChart();
</script>
</body>
</html>
